import{f as Te,i as _e,j as e,g as A,h as oe,k as S,u as q,l as ze,t as Ne,r as x,m as Be,S as O,b as W,n as ee,B as l,o as ce,G as y,T as o,p as z,I as N,q as B,s as We,v as Fe,w as Pe,x as Ae,y as I,z as De,_ as M,a as H,E as D,F as Oe,M as $e,H as te,J as Re,c as de,K as Ee,L as Me,N as qe,O as He,Q as F,R as P,U as Ve,V as Le,W as Ue,X as Ge,Y as Ke,Z as Qe,$ as Xe,a0 as se,a1 as Je,a2 as Ye,a3 as Ze,a4 as et,a5 as tt,a6 as st,a7 as ne,a8 as m,a9 as nt,aa as ae,ab as re,ac as at,ad as ie,ae as rt,af as it,D as lt,ag as ot,ah as ct,ai as le,aj as he,ak as dt,al as ht,am as xt,C as mt,P as ut,an as pt,A as gt,ao as jt,ap as ft}from"./index-YLyOhpv1.js";import{d as bt}from"./ArrowForwardTwoTone-bq5NWPnu.js";import{d as vt}from"./LaunchTwoTone-eJFblB7k.js";import{D as xe}from"./dialog-confirm-delete-DQ-DWuaD.js";const yt=(n,c)=>{let h;return function(...s){clearTimeout(h),h=setTimeout(()=>{n(...s)},c)}};var V={},Ct=_e;Object.defineProperty(V,"__esModule",{value:!0});var me=V.default=void 0,wt=Ct(Te()),St=e,It=(0,wt.default)((0,St.jsx)("path",{d:"M13 7h-2v4H7v2h4v4h2v-4h4v-2h-4V7zm-1-5C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z"}),"AddCircleOutlineOutlined");me=V.default=It;const ue=({open:n,onClose:c,onUpdate:h,customer:s})=>{const j=oe(),r=S(i=>i.common.loading);S(i=>i.common.refresh),q();const{control:f,handleSubmit:p,setValue:C,reset:b,formState:{errors:d}}=ze({resolver:Ne(Ae),defaultValues:{customerId:"",email:"",username:"",firstname:"",lastname:"",phoneNumber:""}}),k=async i=>{try{j(I(!0)),(await De.post("http://52.221.236.203:8080/auth/api/v1/users/customer-ad",{customerId:s.customerId,user:{firstname:i.firstname,lastname:i.lastname,phoneNumber:i.phoneNumber,email:i.email,username:i.username}})).metadata.message==="OK"&&M.success(ee("Tạo tài khoản thành công")),h==null||h(i),b(),c()}catch(g){console.error("Error creating bot:",g)}finally{j(I(!0))}};return x.useEffect(()=>{n||b()},[n]),x.useEffect(()=>{s&&C("customerId",s.customerId)},[s]),e.jsx(e.Fragment,{children:e.jsx(Be,{open:n,onClose:c,title:"Tạo tài khoản quản trị tổ chức ",actions:e.jsx(e.Fragment,{children:e.jsxs(O,{direction:"row",justifyContent:"flex-end",spacing:1,children:[e.jsx(W,{color:"secondary",onClick:()=>c(),children:"Huỷ"}),e.jsxs(W,{variant:"contained",type:"submit",size:"large",fullWidth:!0,sx:{display:"flex",alignItems:"center",justifyContent:"center",gap:"16px"},onClick:p(k),children:[ee("Tạo tài khoản"),r&&e.jsxs(l,{sx:{display:"flex",alignItems:"center",justifyContent:"center",gap:"16px"},color:"common.white",children:[" ",e.jsx(ce,{style:{height:"20px",width:"20px"},color:"inherit"})]})]})]})}),children:e.jsx(O,{spacing:{xs:2,sm:3},children:e.jsx(l,{children:e.jsxs(y,{container:!0,spacing:{xs:2,md:3},children:[e.jsxs(e.Fragment,{children:[e.jsx(y,{item:!0,xs:12,md:6,children:e.jsxs(l,{sx:{display:"flex",alignItems:"center",gap:"10px"},children:[e.jsx(o,{variant:"h6",gutterBottom:!0,component:"label",fontWeight:500,children:"Tên tổ chức:"}),e.jsx(o,{variant:"h6",gutterBottom:!0,component:"label",fontWeight:500,children:s==null?void 0:s.customerName})]})}),e.jsx(y,{item:!0,xs:12,md:6,children:e.jsxs(l,{sx:{display:"flex",alignItems:"center",gap:"10px"},children:[e.jsx(o,{variant:"h6",gutterBottom:!0,component:"label",fontWeight:500,children:"Người đại diện:"}),e.jsx(o,{variant:"h6",gutterBottom:!0,component:"label",fontWeight:500,children:s==null?void 0:s.representative})]})}),e.jsx(y,{item:!0,xs:12,md:6,children:e.jsxs(l,{sx:{display:"flex",alignItems:"center",gap:"10px"},children:[e.jsx(o,{variant:"h6",gutterBottom:!0,component:"label",fontWeight:500,children:"Số điện thoại :"}),e.jsx(o,{variant:"h6",gutterBottom:!0,component:"label",fontWeight:500,children:s==null?void 0:s.phoneNumber})]})}),e.jsx(y,{item:!0,xs:12,md:6,children:e.jsxs(l,{sx:{display:"flex",alignItems:"center",gap:"10px"},children:[e.jsx(o,{variant:"h6",gutterBottom:!0,component:"label",fontWeight:500,children:"Mã số thuế:"}),e.jsx(o,{variant:"h6",gutterBottom:!0,component:"label",fontWeight:500,children:s==null?void 0:s.taxCode})]})})]}),e.jsx(y,{item:!0,xs:12,md:6,children:e.jsx(z,{name:"firstname",control:f,render:({field:i})=>e.jsxs(e.Fragment,{children:[e.jsx(N,{...i,label:"Họ",error:!!d.firstname}),d.firstname&&e.jsx(o,{color:"error",children:d.firstname.message})]})})}),e.jsx(y,{item:!0,xs:12,md:6,children:e.jsx(z,{name:"lastname",control:f,render:({field:i})=>e.jsxs(e.Fragment,{children:[e.jsx(N,{...i,label:"Tên",error:!!d.lastname}),d.lastname&&e.jsx(o,{color:"error",children:d.lastname.message})]})})}),e.jsx(y,{item:!0,xs:12,children:e.jsx(z,{name:"username",control:f,render:({field:i})=>e.jsxs(e.Fragment,{children:[e.jsx(N,{...i,label:"Tài khoản",placeholder:"",error:!!d.username,startAdornment:e.jsx(B,{position:"start",children:e.jsx(We,{fontSize:"small"})})}),d.username&&e.jsx(o,{color:"error",children:d.username.message})]})})}),e.jsx(y,{item:!0,xs:12,children:e.jsx(z,{name:"phoneNumber",control:f,render:({field:i})=>e.jsxs(e.Fragment,{children:[e.jsx(N,{...i,label:"Số điện thoại",error:!!d.phoneNumber,startAdornment:e.jsx(B,{position:"start",children:e.jsx(Fe,{fontSize:"small"})})}),d.phoneNumber&&e.jsx(o,{color:"error",children:d.phoneNumber.message})]})})}),e.jsx(y,{item:!0,xs:12,children:e.jsx(z,{name:"email",control:f,render:({field:i})=>e.jsxs(e.Fragment,{children:[e.jsx(N,{...i,label:"Email",error:!!d.email,startAdornment:e.jsx(B,{position:"start",children:e.jsx(Pe,{fontSize:"small"})})}),d.email&&e.jsx(o,{color:"error",children:d.email.message})]})})})]})})})})})};ue.propTypes={onClose:A.func.isRequired,onUpdate:A.func,open:A.bool.isRequired};const kt=({onDelete:n,onCreate:c})=>{const{t:h}=H(),[s,j]=x.useState(null),r=!!s;x.useState(!1);const f=C=>{j(C.currentTarget)},p=()=>{j(null)};return e.jsx(e.Fragment,{children:e.jsxs(l,{children:[e.jsx(D,{color:"primary","aria-label":"more","aria-controls":"bot-menu","aria-haspopup":"true",onClick:f,children:e.jsx(Oe,{})}),e.jsxs($e,{id:"bot-menu",anchorEl:s,open:r,onClose:p,children:[e.jsx(te,{sx:{width:"100%"},children:e.jsx(xe,{onConfirm:n,children:h("Xóa")})}),e.jsx(te,{onClick:()=>{p(),c()},children:h("Tạo tài khoản quản trị")})]})]})})},Tt=Re(de)(({theme:n})=>`

  position: relative;
  overflow: visible;

  &::after {
    content: '';
    position: absolute;
    width: 100%;
    height: 100%;
    top: 0;
    left: 0;
    border-radius: inherit;
    z-index: 1;
  }
      
    &.Mui-selected::after {
      box-shadow: 0 0 0 3px ${n.palette.primary.main};
    }
  `),_t=(n,c,h)=>n.slice(c*h,c*h+h),L=({users:n,fetchData:c,totalCount:h})=>{const[s,j]=x.useState([]),{t:r}=H(),f=q();Ee(f.breakpoints.up("md"));const[p,C]=x.useState(0),[b,d]=x.useState(15),[k,i]=x.useState(""),[g,v]=x.useState(),[T,w]=x.useState(""),[U,G]=x.useState(),[pe,$]=x.useState(!1);_t(n,p,b);const ge=s.length>0,K=s.length>0&&s.length<n.length,Q=s.length===n.length,[_,je]=x.useState("grid_view"),fe=S(t=>t.common.loading),X=S(t=>t.common.refresh),be=Me(),ve=qe(),R=He(),ye=(t,a)=>{je(a)},J=t=>{j(t.target.checked?n.map(a=>a.customerId):[])},Y=(t,a)=>{s.includes(a)?j(u=>u.filter(E=>E!==a)):j(u=>[...u,a])},Ce=(t,a)=>{C(a),c({pageNumber:a,pageSize:b},g)},we=t=>{d(parseInt(t.target.value)),c({pageNumber:p,pageSize:parseInt(t.target.value)},g)},Se=t=>{let a={...g,...t};for(const u in a)(a[u]===""||a[u]===void 0)&&delete a[u];return v({...a,accent:le(a.search)}),a},Ie=async()=>{if(c&&g){R(I(!0));const t=ct.stringify({...g,accent:le(g==null?void 0:g.search)});c({pageNumber:p,pageSize:b},t).finally(()=>R(I(!1)))}},ke=yt(async t=>{Se({search:t})},900),Z=async t=>{try{const a=await he.deleteCustomer(t);M.success(r(a.data)),R(dt(!X))}catch(a){M.error(r("Something wrong please try again!")),console.log(a)}};return x.useEffect(()=>{c({pageNumber:p,pageSize:b})},[X]),e.jsxs(e.Fragment,{children:[e.jsxs(l,{display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:{xs:"wrap",md:"nowrap"},gap:1,py:2,children:[e.jsxs(l,{display:"flex",order:{xs:1,md:0},alignItems:"center",width:"100%",children:[_==="grid_view"&&e.jsx(F,{arrow:!0,placement:"top",title:r("Select all users"),children:e.jsx(P,{edge:"start",disabled:n.length===0,checked:Q,indeterminate:K,onChange:J})}),ge?e.jsxs(O,{direction:"row",spacing:1,children:[e.jsx(Ve,{}),e.jsx(F,{arrow:!0,placement:"top",title:r("Export user list"),children:e.jsx(Le,{variant:"outlined",color:"secondary",sx:{color:"primary.main"},size:"small",startIcon:e.jsx(Ue,{fontSize:"small"})})})]}):e.jsxs(O,{direction:"row",gap:"10px",width:"100%",children:[e.jsx(l,{width:{xs:"100%",md:"50%"},children:e.jsx(Ge,{margin:"none",fullWidth:!0,InputProps:{startAdornment:e.jsx(B,{position:"start",children:e.jsx(Ke,{})}),endAdornment:k&&e.jsx(B,{position:"end",children:e.jsx(D,{color:"error","aria-label":"clear input",onClick:()=>i(""),edge:"end",size:"small",sx:{color:"error.main"},children:e.jsx(Qe,{fontSize:"small"})})})},onChange:t=>{ke(t.target.value),w(t.target.value)},placeholder:r("Họ tên / email người dùng "),value:T,size:"small",variant:"outlined"})}),e.jsx(W,{variant:"contained",color:"primary",size:"small",sx:{whiteSpace:"nowrap"},onClick:Ie,children:"Tìm kiếm"})]})]}),e.jsxs(Xe,{size:"large",color:"primary",value:_,exclusive:!0,onChange:ye,children:[e.jsx(se,{value:"table_view",children:e.jsx(Je,{})}),e.jsx(se,{value:"grid_view",children:e.jsx(Ye,{})})]})]}),fe?e.jsxs(l,{sx:{display:"flex",alignItems:"center",justifyContent:"center",gap:"16px",height:"50vh"},color:"common.white",children:[" ",e.jsx(ce,{style:{height:"30px",width:"30px"}})]}):n.length===0?e.jsx(e.Fragment,{children:e.jsxs(l,{sx:{minHeight:"50vh"},display:"flex",justifyContent:"center",flexDirection:"column",alignItems:"center",children:[" ",e.jsx("img",{style:{width:"200px"},src:Ze}),e.jsx(o,{variant:"h6",color:"text.secondary",align:"center",fontWeight:500,children:r("Không có dữ liệu khách hàng")})]})}):e.jsxs(e.Fragment,{children:[_==="table_view"&&e.jsx(e.Fragment,{children:e.jsx(de,{children:e.jsx(et,{children:e.jsxs(tt,{children:[e.jsx(st,{children:e.jsxs(ne,{children:[e.jsx(m,{padding:"checkbox",children:e.jsx(P,{checked:Q,indeterminate:K,onChange:J})}),e.jsx(m,{children:r("Ảnh đại diện")}),e.jsx(m,{children:r("Tên tổ chức")}),e.jsx(m,{children:r("Người đại diện")}),e.jsx(m,{children:r("Email/Số điện thoại")}),e.jsx(m,{children:r("Mã số thuế")}),e.jsx(m,{align:"center",children:r("Trạng thái ")}),e.jsx(m,{align:"center",children:r("Hành động")})]})}),e.jsx(nt,{children:n.map((t,a)=>{const u=s.includes(t.customerId);return e.jsxs(ne,{hover:!0,selected:u,children:[e.jsx(m,{padding:"checkbox",children:e.jsx(P,{checked:u,onChange:E=>Y(E,t.customerId),value:u})}),e.jsx(m,{children:e.jsx(l,{display:"flex",alignItems:"center",children:e.jsx(ae,{variant:"rounded",sx:{mr:1},src:t.avatar})})}),e.jsxs(m,{children:[" ",e.jsx(o,{fontWeight:600,children:t.customerName})]}),e.jsx(m,{children:e.jsx(re,{color:"info",label:t==null?void 0:t.representative})}),e.jsxs(m,{children:[e.jsx(o,{fontWeight:600,children:t.email}),e.jsx(o,{fontWeight:600,children:t.phoneNumber})]}),e.jsx(m,{}),e.jsx(m,{align:"center",children:e.jsx(at,{checked:!0,onChange:()=>{},inputProps:{"aria-label":"controlled"}})}),e.jsx(m,{align:"center",children:e.jsxs(o,{noWrap:!0,children:[e.jsx(F,{title:r("Tạo tài khoản quản trị"),arrow:!0,children:e.jsx(D,{color:"success",onClick:()=>{G(t),$(!0)},children:e.jsx(me,{fontSize:"small"})})}),e.jsx(F,{title:r("Xem chi tiết"),arrow:!0,children:e.jsx(D,{onClick:()=>{be(`/customer/${t.customerId}`)},color:"primary",children:e.jsx(vt,{fontSize:"small"})})}),e.jsx(xe,{onConfirm:()=>Z(t==null?void 0:t.customerId)})]})})]},t.id)})})]})})})}),_==="grid_view"&&e.jsx(e.Fragment,{children:n.length===0?e.jsx(o,{sx:{py:{xs:2,sm:3,md:6,lg:10}},variant:"h3",color:"text.secondary",align:"center",children:r("Không có dữ liệu")}):e.jsx(e.Fragment,{children:e.jsx(ie,{container:!0,spacing:{xs:2,sm:3},children:n.map(t=>{const a=s.includes(t.customerId);return e.jsx(ie,{xs:12,sm:6,lg:4,children:e.jsx(Tt,{className:rt({"Mui-selected":a}),children:e.jsxs(l,{sx:{position:"relative",zIndex:"2"},children:[e.jsxs(l,{px:2,pt:2,display:"flex",alignItems:"flex-start",justifyContent:"space-between",children:[e.jsx(re,{style:{maxWidth:"80%"},color:"info",label:t.customerName}),e.jsx(kt,{onDelete:()=>Z(t.customerId),onCreate:()=>{G(t),$(!0)}})]}),e.jsxs(l,{p:2,display:"flex",flexDirection:{xs:"column",md:"row"},alignItems:"flex-start",children:[e.jsx(ae,{variant:"rounded",sx:{width:50,height:50,mr:1.5,mb:{xs:2,md:0}},src:t.avatar}),e.jsxs(l,{children:[e.jsxs(l,{children:[e.jsx(it,{variant:"h6",href:"",onClick:u=>u.preventDefault(),underline:"hover",children:t.name})," ",e.jsx(o,{component:"span",variant:"body2",color:"text.secondary",children:t.customerName})]}),e.jsx(o,{style:{overflow:"hidden",textOverflow:"ellipsis",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical"},sx:{pt:.3},variant:"subtitle2",children:t.phoneNumber}),e.jsx(o,{style:{overflow:"hidden",textOverflow:"ellipsis",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical"},sx:{pt:.3},variant:"subtitle2",children:t.email})]})]}),e.jsx(lt,{}),e.jsxs(l,{pl:2,py:1,pr:1,display:"flex",alignItems:"center",justifyContent:"space-between",children:[e.jsx(W,{variant:"contained",onClick:()=>ve.push(`/customer/${t.customerId}`),endIcon:e.jsx(bt,{}),children:r("Xem chi tiết ")}),e.jsx(P,{checked:a,onChange:u=>Y(u,t.customerId),value:a})]})]})})},t.customerId)})})})}),!_&&e.jsx(l,{sx:{textAlign:"center",p:{xs:2,sm:3}},children:e.jsx(o,{align:"center",variant:"h4",color:"text.secondary",fontWeight:500,sx:{my:{xs:2,sm:3,md:5}},gutterUsertom:!0,children:r("Choose between table or grid views for displaying the users list.")})})]}),e.jsx(l,{pt:2,sx:{".MuiTablePagination-select":{py:.55}},children:e.jsx(ot,{component:"div",count:h,onPageChange:Ce,onRowsPerPageChange:we,page:p,rowsPerPage:b,labelRowsPerPage:"Số hàng mỗi trang",rowsPerPageOptions:[5,15,30,50],slotProps:{select:{variant:"outlined",size:"small",sx:{p:0}}}})}),U&&e.jsx(ue,{customer:U,open:pe,onClose:()=>$(!1)})]})};L.propTypes={users:A.array.isRequired};L.defaultProps={users:[]};const Pt=()=>{const n=q(),{t:c}=H(),h=ht();xt();const[s,j]=x.useState([]),[r,f]=x.useState(!1),p=oe();S(v=>v.common.loading);const C=S(v=>v.common.refresh),[b,d]=x.useState(0),k=()=>{f(!0)},i=()=>{f(!1)},g=x.useCallback(async(v,T)=>{try{p(I(!0));const w=await he.getCustomers({pageNumber:v.pageNumber,pageSize:v.pageSize},T);h()&&(j(w.content),d(w.totalElements))}catch(w){console.error(w)}finally{p(I(!1))}},[h,C]);return e.jsxs(e.Fragment,{children:[e.jsx(l,{px:{xs:2,sm:3},pt:{xs:2,sm:3},component:"main",flex:1,display:"flex",flexDirection:"column",children:e.jsxs(mt,{disableGutters:!0,maxWidth:"xl",children:[e.jsx(l,{pb:{xs:2,sm:3},children:e.jsx(ut,{sx:{px:0},title:c("Khách hàng tổ chức"),description:c("Quản lý tổ chức"),actions:e.jsx(e.Fragment,{children:e.jsx(W,{sx:{mt:{xs:2,md:0}},variant:"contained",onClick:k,startIcon:e.jsx(pt,{fontSize:"small"}),children:c("Tạo tổ chức")})}),iconBox:e.jsx(gt,{isSoft:!0,variant:"rounded",state:"primary",sx:{height:n.spacing(7),width:n.spacing(7),svg:{height:n.spacing(4),width:n.spacing(4),minWidth:n.spacing(4)}},children:e.jsx(jt,{})})})}),e.jsx(l,{pb:{xs:2,sm:3},children:e.jsx(L,{fetchData:g,totalCount:b,users:s})})]})}),e.jsx(ft,{open:r,onClose:i,onUpdate:v=>j(T=>[...T,v])})]})};export{Pt as default};
