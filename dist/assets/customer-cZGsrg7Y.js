import{f as Ne,i as _e,j as e,g as D,h as ce,k as I,u as V,l as ze,t as Be,r as x,m as We,S as R,b as A,n as te,B as l,o as de,G as y,T as o,p as B,I as W,q as F,s as Fe,v as Ae,w as Pe,x as Oe,y as T,z as De,_ as q,a as H,E as $,F as $e,M as Re,H as se,J as he,K as Me,c as xe,L as Ee,N as qe,O as Ve,Q as He,R as P,U as O,V as Le,W as Ue,X as Ge,Y as Ke,Z as Qe,$ as Xe,a0 as Je,a1 as ne,a2 as Ye,a3 as Ze,a4 as et,a5 as tt,a6 as st,a7 as ae,a8 as m,a9 as nt,aa as re,ab as ie,ac as at,ad as le,ae as rt,af as it,D as lt,ag as ot,ah as ct,ai as me,aj as dt,ak as ht,al as xt,C as mt,P as ut,am as pt,A as gt,an as jt,ao as ft}from"./index-8egQHEDr.js";import{d as vt,l as bt,i as oe}from"./validateString-k54MvUbR.js";import{d as yt}from"./LaunchTwoTone-7HaCaCgK.js";var L={},Ct=_e;Object.defineProperty(L,"__esModule",{value:!0});var ue=L.default=void 0,wt=Ct(Ne()),St=e,kt=(0,wt.default)((0,St.jsx)("path",{d:"M13 7h-2v4H7v2h4v4h2v-4h4v-2h-4V7zm-1-5C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z"}),"AddCircleOutlineOutlined");ue=L.default=kt;const pe=({open:a,onClose:d,onUpdate:u,customer:s})=>{const j=ce(),r=I(i=>i.common.loading);I(i=>i.common.refresh),V();const{control:f,handleSubmit:p,setValue:C,reset:v,formState:{errors:c}}=ze({resolver:Be(Oe),defaultValues:{customerId:"",email:"",username:"",firstname:"",lastname:"",phoneNumber:""}}),N=async i=>{try{j(T(!0)),(await De.post("http://52.221.236.203:8080/auth/api/v1/users/customer-ad",{customerId:s.customerId,user:{firstname:i.firstname,lastname:i.lastname,phoneNumber:i.phoneNumber,email:i.email,username:i.username}})).metadata.message==="OK"&&q.success(te("Tạo tài khoản thành công")),u==null||u(i),v(),d()}catch(g){console.error("Error creating bot:",g)}finally{j(T(!0))}};return x.useEffect(()=>{a||v()},[a]),x.useEffect(()=>{s&&C("customerId",s.customerId)},[s]),e.jsx(e.Fragment,{children:e.jsx(We,{open:a,onClose:d,title:"Tạo tài khoản quản trị tổ chức ",actions:e.jsx(e.Fragment,{children:e.jsxs(R,{direction:"row",justifyContent:"flex-end",spacing:1,children:[e.jsx(A,{color:"secondary",onClick:()=>d(),children:"Huỷ"}),e.jsxs(A,{variant:"contained",type:"submit",size:"large",fullWidth:!0,sx:{display:"flex",alignItems:"center",justifyContent:"center",gap:"16px"},onClick:p(N),children:[te("Tạo tài khoản"),r&&e.jsxs(l,{sx:{display:"flex",alignItems:"center",justifyContent:"center",gap:"16px"},color:"common.white",children:[" ",e.jsx(de,{style:{height:"20px",width:"20px"},color:"inherit"})]})]})]})}),children:e.jsx(R,{spacing:{xs:2,sm:3},children:e.jsx(l,{children:e.jsxs(y,{container:!0,spacing:{xs:2,md:3},children:[e.jsxs(e.Fragment,{children:[e.jsx(y,{item:!0,xs:12,md:6,children:e.jsxs(l,{sx:{display:"flex",alignItems:"center",gap:"10px"},children:[e.jsx(o,{variant:"h6",gutterBottom:!0,component:"label",fontWeight:500,children:"Tên tổ chức:"}),e.jsx(o,{variant:"h6",gutterBottom:!0,component:"label",fontWeight:500,children:s==null?void 0:s.customerName})]})}),e.jsx(y,{item:!0,xs:12,md:6,children:e.jsxs(l,{sx:{display:"flex",alignItems:"center",gap:"10px"},children:[e.jsx(o,{variant:"h6",gutterBottom:!0,component:"label",fontWeight:500,children:"Người đại diện:"}),e.jsx(o,{variant:"h6",gutterBottom:!0,component:"label",fontWeight:500,children:s==null?void 0:s.representative})]})}),e.jsx(y,{item:!0,xs:12,md:6,children:e.jsxs(l,{sx:{display:"flex",alignItems:"center",gap:"10px"},children:[e.jsx(o,{variant:"h6",gutterBottom:!0,component:"label",fontWeight:500,children:"Số điện thoại :"}),e.jsx(o,{variant:"h6",gutterBottom:!0,component:"label",fontWeight:500,children:s==null?void 0:s.phoneNumber})]})}),e.jsx(y,{item:!0,xs:12,md:6,children:e.jsxs(l,{sx:{display:"flex",alignItems:"center",gap:"10px"},children:[e.jsx(o,{variant:"h6",gutterBottom:!0,component:"label",fontWeight:500,children:"Mã số thuế:"}),e.jsx(o,{variant:"h6",gutterBottom:!0,component:"label",fontWeight:500,children:s==null?void 0:s.taxCode})]})})]}),e.jsx(y,{item:!0,xs:12,md:6,children:e.jsx(B,{name:"firstname",control:f,render:({field:i})=>e.jsxs(e.Fragment,{children:[e.jsx(W,{...i,label:"Họ",error:!!c.firstname}),c.firstname&&e.jsx(o,{color:"error",children:c.firstname.message})]})})}),e.jsx(y,{item:!0,xs:12,md:6,children:e.jsx(B,{name:"lastname",control:f,render:({field:i})=>e.jsxs(e.Fragment,{children:[e.jsx(W,{...i,label:"Tên",error:!!c.lastname}),c.lastname&&e.jsx(o,{color:"error",children:c.lastname.message})]})})}),e.jsx(y,{item:!0,xs:12,children:e.jsx(B,{name:"username",control:f,render:({field:i})=>e.jsxs(e.Fragment,{children:[e.jsx(W,{...i,label:"Tài khoản",placeholder:"",error:!!c.username,startAdornment:e.jsx(F,{position:"start",children:e.jsx(Fe,{fontSize:"small"})})}),c.username&&e.jsx(o,{color:"error",children:c.username.message})]})})}),e.jsx(y,{item:!0,xs:12,children:e.jsx(B,{name:"phoneNumber",control:f,render:({field:i})=>e.jsxs(e.Fragment,{children:[e.jsx(W,{...i,label:"Số điện thoại",error:!!c.phoneNumber,startAdornment:e.jsx(F,{position:"start",children:e.jsx(Ae,{fontSize:"small"})})}),c.phoneNumber&&e.jsx(o,{color:"error",children:c.phoneNumber.message})]})})}),e.jsx(y,{item:!0,xs:12,children:e.jsx(B,{name:"email",control:f,render:({field:i})=>e.jsxs(e.Fragment,{children:[e.jsx(W,{...i,label:"Email",error:!!c.email,startAdornment:e.jsx(F,{position:"start",children:e.jsx(Pe,{fontSize:"small"})})}),c.email&&e.jsx(o,{color:"error",children:c.email.message})]})})})]})})})})})};pe.propTypes={onClose:D.func.isRequired,onUpdate:D.func,open:D.bool.isRequired};const It=({onDelete:a,onCreate:d})=>{const{t:u}=H(),[s,j]=x.useState(null),r=!!s;x.useState(!1);const f=C=>{j(C.currentTarget)},p=()=>{j(null)};return e.jsx(e.Fragment,{children:e.jsxs(l,{children:[e.jsx($,{color:"primary","aria-label":"more","aria-controls":"bot-menu","aria-haspopup":"true",onClick:f,children:e.jsx($e,{})}),e.jsxs(Re,{id:"bot-menu",anchorEl:s,open:r,onClose:p,children:[e.jsx(se,{sx:{width:"100%"},children:e.jsx(he,{onConfirm:a,children:u("Xóa")})}),e.jsx(se,{onClick:()=>{p(),d()},children:u("Tạo tài khoản quản trị")})]})]})})},Tt=Me(xe)(({theme:a})=>`

  position: relative;
  overflow: visible;

  &::after {
    content: '';
    position: absolute;
    width: 100%;
    height: 100%;
    top: 0;
    left: 0;
    border-radius: inherit;
    z-index: 1;
  }
      
    &.Mui-selected::after {
      box-shadow: 0 0 0 3px ${a.palette.primary.main};
    }
  `),Nt=(a,d,u)=>a.slice(d*u,d*u+u),U=({users:a,fetchData:d,totalCount:u})=>{const[s,j]=x.useState([]),{t:r}=H(),f=V();Ee(f.breakpoints.up("md"));const[p,C]=x.useState(0),[v,c]=x.useState(15),[N,i]=x.useState(""),[g,b]=x.useState(),[_,w]=x.useState(""),[G,K]=x.useState(),[ge,M]=x.useState(!1);Nt(a,p,v);const je=s.length>0,Q=s.length>0&&s.length<a.length,X=s.length===a.length,[z,fe]=x.useState("grid_view"),ve=I(t=>t.common.loading),J=I(t=>t.common.refresh),be=qe(),ye=Ve(),E=He(),Ce=(t,n)=>{fe(n)},Y=t=>{j(t.target.checked?a.map(n=>n.customerId):[])},Z=(t,n)=>{s.includes(n)?j(h=>h.filter(S=>S!==n)):j(h=>[...h,n])},we=(t,n)=>{C(n),d({pageNumber:n,pageSize:v},g)},Se=t=>{c(parseInt(t.target.value)),d({pageNumber:p,pageSize:parseInt(t.target.value)},g)},ke=t=>{let n={...g,...t};for(const h in n)(n[h]===""||n[h]===void 0)&&delete n[h];return b({...n,accent:oe(n.customerName)}),n},Ie=async()=>{if(d&&g){E(T(!0));const t=bt.stringify({...g,accent:oe(g==null?void 0:g.customerName)});d({pageNumber:p,pageSize:v},t).finally(()=>E(T(!1)))}},Te=ct(async t=>{ke({customerName:t})},900),ee=async t=>{var n,h,S;try{const k=await me.deleteCustomer(t);q.success(r(k.data)),E(dt(!J))}catch(k){q.error(((S=(h=(n=k==null?void 0:k.response)==null?void 0:n.data)==null?void 0:h.error)==null?void 0:S.message)??r("Something wrong please try again!")),console.log(k)}};return x.useEffect(()=>{d({pageNumber:p,pageSize:v})},[J]),e.jsxs(e.Fragment,{children:[e.jsxs(l,{display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:{xs:"wrap",md:"nowrap"},gap:1,py:2,children:[e.jsxs(l,{display:"flex",order:{xs:1,md:0},alignItems:"center",width:"100%",children:[z==="grid_view"&&e.jsx(P,{arrow:!0,placement:"top",title:r("Select all users"),children:e.jsx(O,{edge:"start",disabled:a.length===0,checked:X,indeterminate:Q,onChange:Y})}),je?e.jsxs(R,{direction:"row",spacing:1,children:[e.jsx(Le,{}),e.jsx(P,{arrow:!0,placement:"top",title:r("Export user list"),children:e.jsx(Ue,{variant:"outlined",color:"secondary",sx:{color:"primary.main"},size:"small",startIcon:e.jsx(Ge,{fontSize:"small"})})})]}):e.jsxs(R,{direction:"row",gap:"10px",width:"100%",children:[e.jsx(l,{width:{xs:"100%",md:"50%"},children:e.jsx(Ke,{margin:"none",fullWidth:!0,InputProps:{startAdornment:e.jsx(F,{position:"start",children:e.jsx(Qe,{})}),endAdornment:N&&e.jsx(F,{position:"end",children:e.jsx($,{color:"error","aria-label":"clear input",onClick:()=>i(""),edge:"end",size:"small",sx:{color:"error.main"},children:e.jsx(Xe,{fontSize:"small"})})})},onChange:t=>{Te(t.target.value),w(t.target.value)},placeholder:r("Tên / người đại diện"),value:_,size:"small",variant:"outlined"})}),e.jsx(A,{variant:"contained",color:"primary",size:"small",sx:{whiteSpace:"nowrap"},onClick:Ie,children:"Tìm kiếm"})]})]}),e.jsxs(Je,{size:"large",color:"primary",value:z,exclusive:!0,onChange:Ce,children:[e.jsx(ne,{value:"table_view",children:e.jsx(Ye,{})}),e.jsx(ne,{value:"grid_view",children:e.jsx(Ze,{})})]})]}),ve?e.jsxs(l,{sx:{display:"flex",alignItems:"center",justifyContent:"center",gap:"16px",height:"50vh"},color:"common.white",children:[" ",e.jsx(de,{style:{height:"30px",width:"30px"}})]}):a.length===0?e.jsx(e.Fragment,{children:e.jsxs(l,{sx:{minHeight:"50vh"},display:"flex",justifyContent:"center",flexDirection:"column",alignItems:"center",children:[" ",e.jsx("img",{style:{width:"200px"},src:"/src/assets/images/all-img/empty-data.png"}),e.jsx(o,{variant:"h6",color:"text.secondary",align:"center",fontWeight:500,children:r("Không có dữ liệu khách hàng")})]})}):e.jsxs(e.Fragment,{children:[z==="table_view"&&e.jsx(e.Fragment,{children:e.jsx(xe,{children:e.jsx(et,{children:e.jsxs(tt,{children:[e.jsx(st,{children:e.jsxs(ae,{children:[e.jsx(m,{padding:"checkbox",children:e.jsx(O,{checked:X,indeterminate:Q,onChange:Y})}),e.jsx(m,{children:r("Ảnh đại diện")}),e.jsx(m,{children:r("Tên tổ chức")}),e.jsx(m,{children:r("Người đại diện")}),e.jsx(m,{children:r("Email/Số điện thoại")}),e.jsx(m,{children:r("Mã số thuế")}),e.jsx(m,{align:"center",children:r("Trạng thái ")}),e.jsx(m,{align:"center",children:r("Hành động")})]})}),e.jsx(nt,{children:a.map((t,n)=>{const h=s.includes(t.customerId);return e.jsxs(ae,{hover:!0,selected:h,children:[e.jsx(m,{padding:"checkbox",children:e.jsx(O,{checked:h,onChange:S=>Z(S,t.customerId),value:h})}),e.jsx(m,{children:e.jsx(l,{display:"flex",alignItems:"center",children:e.jsx(re,{variant:"rounded",sx:{mr:1},src:t.avatar})})}),e.jsxs(m,{children:[" ",e.jsx(o,{fontWeight:600,children:t.customerName})]}),e.jsx(m,{children:e.jsx(ie,{color:"info",label:t==null?void 0:t.representative})}),e.jsxs(m,{children:[e.jsx(o,{fontWeight:600,children:t.email}),e.jsx(o,{fontWeight:600,children:t.phoneNumber})]}),e.jsx(m,{}),e.jsx(m,{align:"center",children:e.jsx(at,{checked:!0,onChange:()=>{},inputProps:{"aria-label":"controlled"}})}),e.jsx(m,{align:"center",children:e.jsxs(o,{noWrap:!0,children:[e.jsx(P,{title:r("Tạo tài khoản quản trị"),arrow:!0,children:e.jsx($,{color:"success",onClick:()=>{K(t),M(!0)},children:e.jsx(ue,{fontSize:"small"})})}),e.jsx(P,{title:r("Xem chi tiết"),arrow:!0,children:e.jsx($,{onClick:()=>{be(`/customer/${t.customerId}`)},color:"primary",children:e.jsx(yt,{fontSize:"small"})})}),e.jsx(he,{onConfirm:()=>ee(t==null?void 0:t.customerId)})]})})]},t.id)})})]})})})}),z==="grid_view"&&e.jsx(e.Fragment,{children:a.length===0?e.jsx(o,{sx:{py:{xs:2,sm:3,md:6,lg:10}},variant:"h3",color:"text.secondary",align:"center",children:r("Không có dữ liệu")}):e.jsx(e.Fragment,{children:e.jsx(le,{container:!0,spacing:{xs:2,sm:3},children:a.map(t=>{const n=s.includes(t.customerId);return e.jsx(le,{xs:12,sm:6,lg:4,children:e.jsx(Tt,{className:rt({"Mui-selected":n}),children:e.jsxs(l,{sx:{position:"relative",zIndex:"2"},children:[e.jsxs(l,{px:2,pt:2,display:"flex",alignItems:"flex-start",justifyContent:"space-between",children:[e.jsx(ie,{style:{maxWidth:"80%"},color:"info",label:t.customerName}),e.jsx(It,{onDelete:()=>ee(t.customerId),onCreate:()=>{K(t),M(!0)}})]}),e.jsxs(l,{p:2,display:"flex",flexDirection:{xs:"column",md:"row"},alignItems:"flex-start",children:[e.jsx(re,{variant:"rounded",sx:{width:50,height:50,mr:1.5,mb:{xs:2,md:0}},src:t.avatar}),e.jsxs(l,{children:[e.jsxs(l,{children:[e.jsx(it,{variant:"h6",href:"",onClick:h=>h.preventDefault(),underline:"hover",children:t.name})," ",e.jsx(o,{component:"span",variant:"body2",color:"text.secondary",children:t.customerName})]}),e.jsx(o,{style:{overflow:"hidden",textOverflow:"ellipsis",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical"},sx:{pt:.3},variant:"subtitle2",children:t.phoneNumber}),e.jsx(o,{style:{overflow:"hidden",textOverflow:"ellipsis",display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical"},sx:{pt:.3},variant:"subtitle2",children:t.email})]})]}),e.jsx(lt,{}),e.jsxs(l,{pl:2,py:1,pr:1,display:"flex",alignItems:"center",justifyContent:"space-between",children:[e.jsx(A,{variant:"contained",onClick:()=>ye.push(`/customer/${t.customerId}`),endIcon:e.jsx(vt,{}),children:r("Xem chi tiết ")}),e.jsx(O,{checked:n,onChange:h=>Z(h,t.customerId),value:n})]})]})})},t.customerId)})})})}),!z&&e.jsx(l,{sx:{textAlign:"center",p:{xs:2,sm:3}},children:e.jsx(o,{align:"center",variant:"h4",color:"text.secondary",fontWeight:500,sx:{my:{xs:2,sm:3,md:5}},gutterUsertom:!0,children:r("Choose between table or grid views for displaying the users list.")})})]}),e.jsx(l,{pt:2,sx:{".MuiTablePagination-select":{py:.55}},children:e.jsx(ot,{component:"div",count:u,onPageChange:we,onRowsPerPageChange:Se,page:p,rowsPerPage:v,rowsPerPageOptions:[5,15,30,50],slotProps:{select:{variant:"outlined",size:"small",sx:{p:0}}}})}),G&&e.jsx(pe,{customer:G,open:ge,onClose:()=>M(!1)})]})};U.propTypes={users:D.array.isRequired};U.defaultProps={users:[]};const Ft=()=>{const a=V(),{t:d}=H(),u=ht();xt();const[s,j]=x.useState([]),[r,f]=x.useState(!1),p=ce();I(b=>b.common.loading);const C=I(b=>b.common.refresh),[v,c]=x.useState(0),N=()=>{f(!0)},i=()=>{f(!1)},g=x.useCallback(async(b,_)=>{try{p(T(!0));const w=await me.getCustomers({pageNumber:b.pageNumber,pageSize:b.pageSize},_);u()&&(j(w.content),c(w.totalElements))}catch(w){console.error(w)}finally{p(T(!1))}},[u,C]);return e.jsxs(e.Fragment,{children:[e.jsx(l,{px:{xs:2,sm:3},pt:{xs:2,sm:3},component:"main",flex:1,display:"flex",flexDirection:"column",children:e.jsxs(mt,{disableGutters:!0,maxWidth:"xl",children:[e.jsx(l,{pb:{xs:2,sm:3},children:e.jsx(ut,{sx:{px:0},title:d("Khách hàng tổ chức"),description:d("Quản lý tổ chức"),actions:e.jsx(e.Fragment,{children:e.jsx(A,{sx:{mt:{xs:2,md:0}},variant:"contained",onClick:N,startIcon:e.jsx(pt,{fontSize:"small"}),children:d("Tạo tổ chức")})}),iconBox:e.jsx(gt,{isSoft:!0,variant:"rounded",state:"primary",sx:{height:a.spacing(7),width:a.spacing(7),svg:{height:a.spacing(4),width:a.spacing(4),minWidth:a.spacing(4)}},children:e.jsx(jt,{})})})}),e.jsx(l,{pb:{xs:2,sm:3},children:e.jsx(U,{fetchData:g,totalCount:v,users:s})})]})}),e.jsx(ft,{open:r,onClose:i,onUpdate:b=>j(_=>[..._,b])})]})};export{Ft as default};
